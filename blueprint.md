# 健康管理アプリ Blueprint

## 概要

このアプリは、ユーザーが日々の健康状態、服薬状況、カレンダーの予定、タスクなどを一元管理できる総合的な健康管理アプリケーションです。歩数計、睡眠データ、体重などの健康指標を記録・可視化し、日々の生活をサポートします。

さらに、AIを活用した機能として、対話形式で質問に答えるAIチャット、テキストから画像を生成するAI画像生成機能、そして1週間の健康データを基にパーソナライズされたアドバイスを通知する週次レポート機能を搭載しています。

## スタイルとデザイン

- **テーマ:** Material 3デザインをベースとし、`ColorScheme.fromSeed`を使用して、紫を基調とした統一感のあるライトテーマとダークテーマを生成しています。
- **フォント:** `google_fonts`パッケージを利用し、見出しには`Oswald`、本文には`Roboto`や`Open Sans`を使用して、可読性とデザイン性を両立させています。
- **UIコンポーネント:**
  - `ElevatedButton`や`AppBar`などの主要なウィジェットは、アプリのテーマに合わせてスタイルが統一されています。
  - チャット画面では、ユーザーとAIのメッセージが左右に分かれて表示され、直感的な対話が可能です。
- **レイアウト:** レスポンシブデザインを意識し、様々な画面サイズに対応できるよう、`Expanded`や`ListView`などを効果的に使用しています。

## 実装された機能

- **タスク管理:**
    - タスクの追加、表示、完了ステータスの切り替え。
    - タスクに1, 2, 3の3段階で優先度を設定する機能（デフォルトは2）。
- **カレンダー:**
  - `table_calendar`を使用してイベントや予定を管理。
  - `device_calendar`と連携し、デバイスのネイティブカレンダーの予定も表示・操作。
- **健康管理 (ヘルスケア):**
  - `health`パッケージを使用して、歩数、体重、睡眠時間などの健康データを取得。
  - `fl_chart`で健康データをグラフ化し、週次レポートとして可視化。
  - AIチャットへの導線となる吹き出し型ボタンを設置。
  - AIが生成したキャラクター画像を表示。
- **経路生成:**
  - `google_maps_flutter`と`location`を使用し、現在地から目的地までのルートを地図上に表示。
- **AI機能 (Firebase AI - Gemini):**
  - **AIチャット:** `firebase_ai`を利用した対話型AI。ユーザーの質問に対してリアルタイムで応答。
  - **週次レポート通知:** `workmanager`でバックグラウンドタスクをスケジュールし、`health`パッケージで収集した直近1週間の健康データをGeminiが分析・要約。その結果を`flutter_local_notifications`でユーザーに通知。
- **その他:**
  - メモ機能
  - ユーザー登録機能
  - ゲーム機能
  - **通知設定:**
    - 服薬管理機能への導線。
    - 週次レポート通知の有効化、曜日、時間の設定機能。
  - AIのキャラクターを設定するための画像生成画面への導線を設置。

## 今回の変更: タスクへの優先度設定機能の追加とデフォルト値の変更

ユーザーがタスクをより効果的に管理できるよう、優先度を設定する機能を追加し、デフォルトの優先度を「2」に変更しました。

### 変更の目的
- 多数のタスクの中から、重要度の高いものをユーザーが一目で識別できるようにする。
- タスク管理の効率性を向上させる。

### 主な手順と変更点

1.  **モデルの更新 (`lib/models/task.dart`):**
    - `Task`クラスに、優先度を保存するための`priority`フィールド（`int`型）を追加しました。

2.  **タスク追加画面の更新 (`lib/task_add_screen.dart`):**
    - 優先度（1, 2, 3）を選択するためのUIとして`ChoiceChip`を実装しました。
    - **デフォルトの優先度を「2」に設定しました。** `_selectedPriority`の初期値を`2`に変更し、画面表示時に「2」が選択された状態になるようにしています。
    - ユーザーが選択した優先度を新しいタスクの`priority`プロパティに設定して保存するように、フォームの送信ロジックを更新しました。

3.  **タスク一覧画面の更新 (`lib/task_screen.dart`):**
    - `ListView`内の`ListTile`を更新し、各タスクのタイトルの横に「(Priority: X)」という形式で優先度が表示されるように変更しました。これにより、ユーザーは一覧画面で各タスクの重要度をすぐに把握できます。
